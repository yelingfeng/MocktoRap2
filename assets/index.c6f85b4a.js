import{x as random,y as reduce,d as defineComponent,z as ref,u as useMessage,o as openBlock,c as createBlock,a as createVNode,w as withCtx,A as createTextVNode,r as resolveComponent}from"./vendor.e01eae54.js";const toString=Object.prototype.toString;function is(e,t){return toString.call(e)===`[object ${t}]`}function isObject(e){return null!==e&&is(e,"Object")}function isNumber(e){return is(e,"Number")}function isString(e){return is(e,"String")}function isArray(e){return e&&Array.isArray(e)}const getRandomId=()=>{const e=`${random(10,30)}${random(10,50)}00${random(10,99)}`;return Number(e)},interfaceId=getRandomId(),creatorId=161514,_transformType=e=>isNumber(e)?"Number":isArray(e)?"Array":isObject(e)?"Object":"String",array2RapOrder=e=>`@order(${e.map((e=>isString(e)?`'${e}'`:isNumber(e)?e:void 0))})`,getArrayChildProps=(e,t)=>{const r=[];return Object.entries(e).map((([e,a])=>{if(null!==a){const o=array2RapOrder(a),n=_transformType(a[0]),s={id:getRandomId(),type:n,name:e,rule:"",pid:t,value:o};r.push(renderProps(s))}})),r},_transformValue=(e,t)=>{if(isArray(e)){const r=reduce(e,((e,t,r)=>(Object.entries(t).map((([t,r])=>{null!==r?e[t]?e[t].push(r):e[t]=[r]:e[t]=null})),e)),{});return getArrayChildProps(r,t)}return e},renderProps=({id:e,type:t,name:r,rule:a,value:o,desc:n="",pid:s,priority:l=1})=>({id:e,scope:"response",type:t,pos:2,name:r,rule:a,value:o,description:n,parentId:s,priority:l,required:!1,creatorId:creatorId}),_transProperties=e=>{const t=[];return Object.entries(e).map((([e,r])=>{const a=_transformType(r),o={id:getRandomId(),type:a,name:e,rule:"",pid:-1,value:r};if(isArray(r)){_transformValue(r,o.id).map((e=>{t.push(e)})),r.length&&(o.name=`${o.name}|${r.length}`),o.value=""}const n=renderProps(o);t.push(n)})),t},_transInterfaceJson=({name:e,url:t,method:r,bodyOption:a="FORM_DATA",description:o=""})=>({id:interfaceId,name:e,url:t,method:r,bodyOption:a,description:o,priority:1,status:200,creatorId:creatorId}),transformMock=(e,t)=>({itf:_transInterfaceJson({name:t.name,url:t.url,method:t.method,bodyOption:t.bodyOption,description:t.desc}),properties:_transProperties(e)});var _sfc_main=defineComponent({name:"MockRap",props:{opt:{type:Object,default:()=>({})}},setup(props){ref(props.opt);const transData=ref({}),jsonData=ref(""),formRef=ref(null),message=useMessage(),size=ref("medium"),options=[{label:"POST",value:"POST"},{label:"GET",value:"GET"},{label:"DELETE",value:"DELETE"},{label:"PUT",value:"PUT"}],intefaceForm=ref({name:"",url:"",method:"GET",bodyOption:"",desc:""}),rules={name:{required:!0,message:"请输入接口名",trigger:"blur"},url:{required:!0,message:"请输入接口URL",trigger:["input","blur"]},method:{required:!0,message:"请输入接口method",trigger:["input"]}},transClick=()=>{formRef.value.validate((errors=>{if(errors)console.log(errors),message.error("Invalid");else{const json=eval("("+jsonData.value+")");transData.value=transformMock(json,intefaceForm.value)}}))};return{size:size,formRef:formRef,rules:rules,options:options,jsonData:jsonData,transClick:transClick,transData:transData,intefaceForm:intefaceForm}}}),index_vue_vue_type_style_index_0_lang="\n.box {\n  text-align: left;\n  width: 1200px;\n  margin: 20px auto;\n}\n";const _hoisted_1={class:"box"},_hoisted_2=createTextVNode("转换");function _sfc_render(e,t,r,a,o,n){const s=resolveComponent("n-input"),l=resolveComponent("n-form-item"),i=resolveComponent("n-select"),d=resolveComponent("n-button"),u=resolveComponent("n-form"),c=resolveComponent("n-layout-header"),p=resolveComponent("n-layout-sider"),m=resolveComponent("json-viewer"),f=resolveComponent("n-layout");return openBlock(),createBlock("div",_hoisted_1,[createVNode(f,{style:{height:"600px"}},{default:withCtx((()=>[createVNode(c,{style:{height:"100px",padding:"5px"},bordered:""},{default:withCtx((()=>[createVNode(u,{ref:"formRef",inline:"","label-width":100,model:e.intefaceForm,rules:e.rules,size:e.size},{default:withCtx((()=>[createVNode(l,{label:"接口名称",path:"name"},{default:withCtx((()=>[createVNode(s,{value:e.intefaceForm.name,"onUpdate:value":t[1]||(t[1]=t=>e.intefaceForm.name=t),placeholder:"请输入接口名称"},null,8,["value"])])),_:1}),createVNode(l,{label:"接口URL",path:"url"},{default:withCtx((()=>[createVNode(s,{value:e.intefaceForm.url,"onUpdate:value":t[2]||(t[2]=t=>e.intefaceForm.url=t),placeholder:"请输入URL"},null,8,["value"])])),_:1}),createVNode(l,{label:"接口类型",path:"method"},{default:withCtx((()=>[createVNode(i,{value:e.intefaceForm.method,"onUpdate:value":t[3]||(t[3]=t=>e.intefaceForm.method=t),options:e.options},null,8,["value","options"])])),_:1}),createVNode(l,{label:"接口BodyOption",path:"bodyOption"},{default:withCtx((()=>[createVNode(s,{value:e.intefaceForm.bodyOption,"onUpdate:value":t[4]||(t[4]=t=>e.intefaceForm.bodyOption=t),placeholder:"请输入接口BodyOption"},null,8,["value"])])),_:1}),createVNode(l,{label:"接口备注",path:"desc"},{default:withCtx((()=>[createVNode(s,{value:e.intefaceForm.desc,"onUpdate:value":t[5]||(t[5]=t=>e.intefaceForm.desc=t),placeholder:"desc"},null,8,["value"])])),_:1}),createVNode(l,null,{default:withCtx((()=>[createVNode(d,{size:"small",type:"primary",onClick:e.transClick},{default:withCtx((()=>[_hoisted_2])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model","rules","size"])])),_:1}),createVNode(f,{position:"absolute",style:{top:"100px"},"has-sider":""},{default:withCtx((()=>[createVNode(p,{"native-scrollbar":!1,"collapse-mode":"width","collapsed-width":300,width:500,"show-trigger":"arrow-circle","content-style":"padding: 24px;",bordered:""},{default:withCtx((()=>[createVNode(s,{value:e.jsonData,"onUpdate:value":t[6]||(t[6]=t=>e.jsonData=t),type:"textarea",rows:20,placeholder:"请复制JSON数据"},null,8,["value"])])),_:1}),createVNode(f,{"content-style":"padding: 24px;","native-scrollbar":!1},{default:withCtx((()=>[createVNode(m,{value:e.transData,"expand-depth":3,copyable:"",sort:""},null,8,["value"])])),_:1})])),_:1})])),_:1})])}_sfc_main.render=_sfc_render;export{_sfc_main as _};
